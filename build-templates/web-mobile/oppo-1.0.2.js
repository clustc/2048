!function(){function e(e){var o=window.location.search,n=new RegExp("(^|&)"+e+"=([^&]*)(&|$)","i"),i=o.substr(o.indexOf("?")+1).match(n);return null!=i?i[2]:""}function o(e,o){var n={event:T.event,tags:{name:e.action||604,imei:w.imei,model:w.model,osv:w.osv,romv:w.romv,av:w.av,ch:T.channelid,sysid:T.systemid,netid:w.netid},timestamp:Date.now()};for(var i in o)n.tags[i]=o[i];var t=encodeURIComponent(JSON.stringify(n)),a=N+L+"?data="+t+"&callback=_oppoReportLoad",c=document.createElement("script");c.src=a,c.onload=function(){document.head.removeChild(this)},document.head.appendChild(c)}function n(){V||(o({action:601},{type:2,page_id:S,act_id:O,pkg:C}),V=!0)}function i(e){o({action:602},{type:e,act_id:O,pkg:C})}function t(){o({action:602},{type:31,act_id:O,pkg:C,token:w.token})}function a(e){o({action:603},{type:e,act_id:O,pkg:C,token:w.token})}function c(e,o){var n=document.createElement("script");n.src=e,n.onload=function(){document.head.removeChild(this)},n.onerror=function(){o({code:999,msg:"接口调用失败"})},document.head.appendChild(n)}function r(){return"oppo_callback_"+_++}function p(e){var o=[];for(var n in e)o.push(n+"="+encodeURIComponent(e[n]));return o.join("&")}function l(){setTimeout(function(){w.token=m.getLoginInfo().token,w.netid=m.getNetworkType().network},500)}function d(e){var o=document.createElement("iframe"),n={notify_url:e.notify_url,product_name:e.product_name,product_desc:e.product_desc,package_name:e.package_name,app_version:e.app_version,source:e.source,amount:e.amount,channel_id:e.channel_id,currency_name:"人民币",exchange_ratio:"1.0",partner_id:e.partner_id,pay_type:"1",partner_order:e.order_id,app_code:e.app_code,app_key:e.app_key,token:e.token,sign:e.sign};o.style.display="none",document.body.appendChild(o),o.src="kekepay://nearme.atlas.com?"+p(n),setTimeout(function(){document.body.removeChild(o),o=null},1e3)}var s,m={},g=!(!window.android||!window.android.getImei),u=!1,f=!1;g&&(s=window.android,s.downloadByPid?u=!0:f=!0);var k={};m.getIMEI=function(){return g?(k.imei||(k.imei=s.getImei()),{imei:k.imei}):{imei:"000000000000000"}},m.makeToast=function(e){g?s.makeToast(e.msg):alert(e.msg)},m.getAppVersion=function(){if(g){if(!k.app_ver){var e={api:"tool",type:"tool_get_version_and_platform"};k.app_ver=s.callNativeApi(JSON.stringify(e))}var o=JSON.parse(k.app_ver);return{version:o.versioncode,app:o.platform}}return{version:"0001",app:"market"}},m.dialNumber=function(e){if(g){var o={api:"jump",type:"jump_dial",id:e.number+""};s.callNativeApi(JSON.stringify(o))}else console.log("dial number:"+e.number)},m.forceLogin=function(){if(g){var e={type:"reLoginAccount"};s.callNativeApi(JSON.stringify(e))}else console.log("force login")},m.getNetworkType=function(){return g?{network:s.getNetworkType()}:{network:"wifi"}},m.getLoginInfo=function(){var e="",o="",n="";if(g){if(f){var i=s.getLoginInfo();i=i.split(";"),e=i[0],o=i[1],n=i[2]}else e=s.getToken(),o=s.getMobileName();e=decodeURIComponent(e)}return{token:e,model:o,other:n}},m.isLogin=function(){if(g){var e=s.isLogin().toLowerCase();return{login:"true"==e}}return"127.0.0.1"==location.hostname?{login:!0}:{login:!1}},m.doStartLogin=function(){g?f?s.doStartLogin(!0):s.startLogin():console.log("call native login")},m.isInstalled=function(e){return g?e["package"]?{install:"true"==s.isInstalled(e["package"]).toLowerCase()}:(console.log("no package for isInstalled"),null):{install:!1}},m.openAppDetail=function(e){g?f?s.openActivity("oap://gc/dt?id="+e.masterid):s.openActivity("oap://mk/dt?id="+e.masterid):console.log("call native:openActivity")},m.openApp=function(e){if(g){if(!e["package"])return void console.log("no package for openApp");f?s.openGame(e["package"]):s.openApp(e["package"])}else console.log("call native:openApp")},m.openWebView=function(e){g?s.openWebView(e.title,e.url,e.type||0):window.location.assign(e.url)},m.closePage=function(){g?s.closePage():console.log("call native:closePage")};var v={},_=0,y="1.0",w={imei:"000000000000000",model:"",token:"",osv:"",romv:"",av:"",netid:"wifi"},h={androidVersionName:"",colorOsVersion:""},N="https://epoch.cdo.oppomobile.com",L="/soporcollect/wapevent/v1/event",b="https://isdk.oppomobile.com",I="/gamelogin/h5/v1",A="/gamepay/h5/v1";w.imei=m.getIMEI().imei,w.model=m.getLoginInfo().model,w.token=m.getLoginInfo().token,w.netid=m.getNetworkType().network,h.imei=w.imei,h.model=w.model;var C="",O=e("oppoact"),S=e("oppopage"),T={event:2006,channelid:2201,systemid:1e3};window._oppoReportLoad=function(e){console.log(e)};var V=!1;v.checkPay=function(e){e(m.isInstalled({"package":"com.nearme.atlas",masterid:10057477}).install)},v.login=function(e){if(C=e.packageName,n(),m.isLogin().login){var o=b+I+"?",t=r(),d={token:m.getLoginInfo().token,pkgName:e.packageName};d.header=JSON.stringify(h),d.callback=t,window[t]=function(o){200==o.code?(o.token=d.token,a(11)):1005==o.code&&(a(12),m.forceLogin(),l()),e.callback(o)},i(21),c(o+p(d),e.callback)}else i(22),m.doStartLogin(),l()},v.pay=function(e){if(m.isLogin().login){C=e.packageName;var o=m.getLoginInfo().token,n=b+A+"?",i=r(),s={token:o,pkgName:e.packageName,cpOrderId:e.orderId,price:e.price,productName:e.productName,productDesc:e.productDesc,cpCallbackUrl:e.callbackUrl,appVersion:e.appVersion,sdkVersion:y};s.header=JSON.stringify(h),s.callback=i,t(),window[i]=function(n){200==n.code?(a(21),d({notify_url:n.callBackUrl,product_name:e.productName,product_desc:e.productDesc,channel_id:n.channel,partner_id:n.channel,source:e.appName,package_name:e.packageName,amount:(e.price/100).toFixed(2),order_id:n.orderId,app_version:e.appVersion,app_code:e.appVersion,app_key:e.appKey,token:o,sign:n.sign}),setTimeout(function(){e.callback({code:200,msg:""})},500)):(a(22),1005==n.code&&(m.forceLogin(),l()),e.callback(n))},c(n+p(s),e.callback)}else m.doStartLogin(),l()},window.OPPO=v}();